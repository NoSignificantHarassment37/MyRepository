<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>
    <form>
        <fieldset>
            <legend>Inserte la informacion de su empleado</legend>
        </fieldset>
        <label for="empleados-form__nombre">Nombre del empleado</label>
        <input id="empleados-form__nombre" name="nombre" type="text" />

        <label for="empleados-form__edad">Edad del empleado</label>
        <input id="empleados-form__edad" name="edad" type="text" />

        <label for="empleados-form__ciudad">Ciudad de nacimiento del empleado</label>
        <input id="empleados-form__ciudad" name="ciudad" type="text" />

        <label for="empleados-form__direccion">Direccion del empleado</label>
        <input id="empleados-form__direccion" name="direccion" type="text" />
    </form>
    <ul id="empleados"></ul>

    <script>
        const empleadosDisplay = document.getElementById("empleados");

        async function cargarEmpleados() {
            // Limpia el contenedor antes de volver a cargar
            empleadosDisplay.innerHTML = '';

            try {
                const response = await fetch("Empleados/Obtener"); // Usa la URL completa si hace falta
                let empleados;

                try {
                    empleados = await response.json();
                } catch (error) {
                    console.log(`Error al deserializar la respuesta JSON: ${error}`);
                    return;
                }

                empleados.forEach(empleadoJSON => {
                    const empleadoItem = document.createElement('li');
                    empleadoItem.className = 'virtualEmpleado';
                    empleadoItem.innerHTML = `
                            <table>
                                <thead>
                                    <tr>
                                        <th>Característica</th>
                                        <th>Valor</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Nombre</td>
                                        <td>${empleadoJSON.nombre}</td>
                                    </tr>
                                    <tr>
                                        <td>Edad</td>
                                        <td>${empleadoJSON.edad}</td>
                                    </tr>
                                    <tr>
                                        <td>Ciudad de nacimiento</td>
                                        <td>${empleadoJSON.ciudadNacimiento}</td>
                                    </tr>
                                    <tr>
                                        <td>Dirección</td>
                                        <td>${empleadoJSON.direccion}</td>
                                    </tr>
                                    <tr>
                                        <td>Fecha de creación</td>
                                        <td>${new Date(empleadoJSON.fechaDeCreacion).toLocaleString()}</td>
                                    </tr>
                                </tbody>
                            </table>
                        `;
                    empleadosDisplay.appendChild(empleadoItem);
                });

            } catch (error) {
                console.log(`Error de red o fetch: ${error}`);
            }
        }

        // Ejecuta al cargar la página
        cargarEmpleados();
    </script>
</body>
</html>
